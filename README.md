# Attention 任务提醒工具

Attention 是一个基于 Python 与 Tkinter 的桌面悬浮任务提醒应用。它提供系统托盘控制、任务历史记录、外观自定义和中英双语界面，适合日常规划与任务跟踪。

## 功能亮点

- **悬浮提醒**：窗口始终置顶、背景透明，可拖拽至任意位置。
- **快捷编辑**：双击任务文本即可快速修改，`Esc` 键可隐藏窗口。
- **系统托盘**：托盘菜单支持显示/隐藏、开始任务、暂停/继续、终止、编辑与查看历史。
- **任务状态颜色**：开始为红色、暂停为蓝色、终止为白色，状态一目了然。
- **时间跟踪**：在文本下方实时显示开始时间与已持续时长（分钟或“X小时Y分”）。
- **个性化设置**：支持字体、字号、文字颜色、描边颜色、透明度等配置，并可切换中文或英文界面。
- **历史记录**：自动记录每日任务事件（开始、暂停、继续、终止），可按日期查看。

## 环境要求

- Windows 10 / 11
- Python 3.10 及以上

## 安装与运行

```powershell
# 克隆仓库
git clone <repo-url>
cd attention

# 创建并激活虚拟环境（推荐）
python -m venv .venv
.venv\Scripts\activate

# 安装依赖
pip install pystray pillow
# 或依据 pyproject 配置执行 uv / poetry / pip install -r requirements.txt

# 启动应用
python main.py
```

程序运行后会在工作目录生成：

- `config.json`：保存窗口位置、任务文本和外观设置。
- `task_history.json`：按日期存储任务历史事件。

## 使用指南

### 窗口操作

- 鼠标左键拖拽可移动悬浮窗口。
- 双击文本弹出输入框，可立即修改任务内容。
- 按下 `Esc` 键或选择“隐藏窗口”可最小化到托盘。

### 任务管理

| 操作入口 | 描述 |
| --- | --- |
| 右键窗口 / 托盘 → **开始任务** | 输入任务名称并开始计时，文字变红。 |
| 右键 / 托盘 → **暂停任务** | 文本颜色变蓝，并在前缀显示“暂停中”。 |
| 右键 / 托盘 → **继续任务** | 状态恢复为进行中，颜色重新变红。 |
| 右键 / 托盘 → **终止任务** | 文本显示“暂无任务”，颜色变为白色。 |
| 右键 / 托盘 → **查看任务历史** | 打开历史窗口，按日期查看事件列表。 |

> 历史窗口支持选择日期，展示发生时间、事件类型（已开始/已暂停/已继续/已终止）以及对应任务标题。

### 设置面板

托盘或右键菜单选择 **编辑任务...** 即可打开配置对话框：

- 修改任务文本
- 设置字体名称、字号（8–96）
- 调整文字颜色、描边颜色（`#RRGGBB`）
- 设置透明度（0.2–1.0）
- 切换语言（中文 / English）

保存后配置立即生效并写入 `config.json`。

## 项目结构

```
attention/
├── attention/
│   ├── __init__.py      # 暴露 TaskApp、TaskConfig、CONFIG_FILE
│   ├── config.py        # 配置模型及校验
│   ├── constants.py     # 默认常量与路径
│   ├── history.py       # 历史记录读写
│   ├── i18n.py          # 中英双语字典
│   └── ui.py            # Tkinter UI 与业务逻辑
├── floating_task.py     # CLI 入口，可传递参数覆盖配置
├── main.py              # 默认启动脚本
├── config.json          # 运行时生成的用户配置
├── task_history.json    # 运行时生成的任务历史
└── README.md
```

## 常见问题

1. **窗口透明但无法拖动？**  
   请确保鼠标按在文本区域，透明区域不会捕获拖动事件。

2. **托盘图标未出现？**  
   Tkinter + pystray 在部分系统需要数秒初始化，若长时间无反应，可退出后重新运行。

3. **历史窗口出现 “bad screen distance” 错误？**  
   请更新到最新代码并再次运行；该问题已修复。

4. **如何清空历史记录？**  
   退出程序后删除或清空 `task_history.json` 文件即可。

## 贡献与反馈

欢迎通过 Issue 或 Pull Request 提交问题、建议与改进。如果遇到 Bug，请附带日志和复现步骤，方便快速定位。

## 许可证

根据项目需求补充相应许可证（如 MIT、Apache-2.0 等）。若尚未决定，请在此说明。
